!function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager");const t=e=>t=>(e=>{const t=typeof e;return null===e?"null":"object"===t&&Array.isArray(e)?"array":"object"===t&&(n=r=e,o=(s=String).prototype,o.isPrototypeOf(n)||(null===(i=r.constructor)||void 0===i?void 0:i.name)===s.name)?"string":t;var n,o;var r,s,i})(t)===e,n=e=>t=>typeof t===e,o=t("string"),r=t("object"),s=t("array"),i=n("boolean"),l=e=>!(e=>null==e)(e),a=n("function"),d=n("number"),c=()=>{},m=e=>()=>e,u=(e,t)=>e===t;const p=e=>t=>!e(t),f=m(!1);class g{constructor(e,t){this.tag=e,this.value=t}static some(e){return new g(!0,e)}static none(){return g.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?g.some(e(this.value)):g.none()}bind(e){return this.tag?e(this.value):g.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:g.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw new Error(null!=e?e:"Called getOrDie on None")}static from(e){return l(e)?g.some(e):g.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}g.singletonNone=new g(!1);const h=Array.prototype.slice,y=Array.prototype.indexOf,v=Array.prototype.push,C=(e,t)=>{return n=e,o=t,y.call(n,o)>-1;var n,o},b=(e,t)=>{for(let n=0,o=e.length;n<o;n++){if(t(e[n],n))return!0}return!1},N=(e,t)=>{const n=e.length,o=new Array(n);for(let r=0;r<n;r++){const n=e[r];o[r]=t(n,r)}return o},S=(e,t)=>{for(let n=0,o=e.length;n<o;n++){t(e[n],n)}},L=(e,t)=>{const n=[];for(let o=0,r=e.length;o<r;o++){const r=e[o];t(r,o)&&n.push(r)}return n},D=(e,t,n)=>(S(e,((e,o)=>{n=t(n,e,o)})),n),T=(e,t,n)=>{for(let o=0,r=e.length;o<r;o++){const r=e[o];if(t(r,o))return g.some(r);if(n(r,o))break}return g.none()},O=(e,t)=>T(e,t,f),A=(e,t)=>(e=>{const t=[];for(let n=0,o=e.length;n<o;++n){if(!s(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);v.apply(t,e[n])}return t})(N(e,t)),x=e=>{const t=h.call(e,0);return t.reverse(),t},E=(e,t)=>t>=0&&t<e.length?g.some(e[t]):g.none(),k=e=>E(e,0),w=e=>E(e,e.length-1),B=(e,t)=>{const n=[],o=a(t)?e=>b(n,(n=>t(n,e))):e=>C(n,e);for(let t=0,r=e.length;t<r;t++){const r=e[t];o(r)||n.push(r)}return n},P=(e,t,n=u)=>e.exists((e=>n(e,t))),M=(e,t,n)=>e.isSome()&&t.isSome()?g.some(n(e.getOrDie(),t.getOrDie())):g.none(),I=e=>{if(null==e)throw new Error("Node cannot be null or undefined");return{dom:e}},R={fromHtml:(e,t)=>{const n=(t||document).createElement("div");if(n.innerHTML=e,!n.hasChildNodes()||n.childNodes.length>1){const t="HTML does not have a single root node";throw console.error(t,e),new Error(t)}return I(n.childNodes[0])},fromTag:(e,t)=>{const n=(t||document).createElement(e);return I(n)},fromText:(e,t)=>{const n=(t||document).createTextNode(e);return I(n)},fromDom:I,fromPoint:(e,t,n)=>g.from(e.dom.elementFromPoint(t,n)).map(I)},U=(e,t)=>{const n=e.dom;if(1!==n.nodeType)return!1;{const e=n;if(void 0!==e.matches)return e.matches(t);if(void 0!==e.msMatchesSelector)return e.msMatchesSelector(t);if(void 0!==e.webkitMatchesSelector)return e.webkitMatchesSelector(t);if(void 0!==e.mozMatchesSelector)return e.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")}},$=(e,t)=>e.dom===t.dom,H=U,_="undefined"!=typeof window?window:Function("return this;")(),F=(e,t)=>((e,t)=>{let n=null!=t?t:_;for(let t=0;t<e.length&&null!=n;++t)n=n[e[t]];return n})(e.split("."),t),V=(e,t)=>{const n=((e,t)=>F(e,t))(e,t);if(null==n)throw new Error(e+" not available on this browser");return n},j=Object.getPrototypeOf,K=e=>{const t=F("ownerDocument.defaultView",e);return r(e)&&((e=>V("HTMLElement",e))(t).prototype.isPrototypeOf(e)||/^HTML\w*Element$/.test(j(e).constructor.name))},z=e=>e.dom.nodeName.toLowerCase(),Q=e=>e.dom.nodeType,W=e=>t=>Q(t)===e,q=e=>Z(e)&&K(e.dom),Z=W(1),G=W(3),J=W(11),X=e=>t=>Z(t)&&z(t)===e,Y=e=>g.from(e.dom.parentNode).map(R.fromDom),ee=e=>N(e.dom.childNodes,R.fromDom),te=(e,t)=>{const n=e.dom.childNodes;return g.from(n[t]).map(R.fromDom)},ne=e=>te(e,0),oe=e=>te(e,e.dom.childNodes.length-1),re=e=>{const t=(e=>R.fromDom(e.dom.getRootNode()))(e);return J(n=t)&&l(n.dom.host)?g.some(t):g.none();var n},se=e=>R.fromDom(e.dom.host),ie=e=>{const t=G(e)?e.dom.parentNode:e.dom;if(null==t||null===t.ownerDocument)return!1;const n=t.ownerDocument;return re(R.fromDom(t)).fold((()=>n.body.contains(t)),(o=ie,r=se,e=>o(r(e))));var o,r};var le=(e,t,n,o,r)=>e(n,o)?g.some(n):a(r)&&r(n)?g.none():t(n,o,r);const ae=(e,t,n)=>{let o=e.dom;const r=a(n)?n:f;for(;o.parentNode;){o=o.parentNode;const e=R.fromDom(o);if(t(e))return g.some(e);if(r(e))break}return g.none()},de=(e,t,n)=>le(((e,t)=>t(e)),ae,e,t,n),ce=(e,t,n)=>ae(e,(e=>U(e,t)),n),me=e=>{return le(((e,t)=>U(e,t)),ce,e,"[contenteditable]",t);var t},ue=e=>e.dom.contentEditable,pe=(e,t)=>{Y(e).each((n=>{n.dom.insertBefore(t.dom,e.dom)}))},fe=(e,t)=>{const n=(e=>g.from(e.dom.nextSibling).map(R.fromDom))(e);n.fold((()=>{Y(e).each((e=>{ge(e,t)}))}),(e=>{pe(e,t)}))},ge=(e,t)=>{e.dom.appendChild(t.dom)},he=(e,t)=>{S(t,(t=>{ge(e,t)}))},ye=e=>{e.dom.textContent="",S(ee(e),(e=>{ve(e)}))},ve=e=>{const t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)};var Ce=tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"),be=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),Ne=tinymce.util.Tools.resolve("tinymce.util.VK");const Se=e=>N(e,R.fromDom),Le=Object.keys,De=(e,t)=>{const n=Le(e);for(let o=0,r=n.length;o<r;o++){const r=n[o];t(e[r],r)}},Te=(e,t)=>{const n={};var o;return((e,t,n,o)=>{De(e,((e,r)=>{(t(e,r)?n:o)(e,r)}))})(e,t,(o=n,(e,t)=>{o[t]=e}),c),n},Oe=(e,t)=>{const n=e.dom;De(t,((e,t)=>{((e,t,n)=>{if(!(o(n)||i(n)||d(n)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")})(n,t,e)}))},Ae=e=>D(e.dom.attributes,((e,t)=>(e[t.name]=t.value,e)),{}),xe=e=>((e,t)=>R.fromDom(e.dom.cloneNode(t)))(e,!0),Ee=(e,t)=>{const n=((e,t)=>{const n=R.fromTag(t),o=Ae(e);return Oe(n,o),n})(e,t);fe(e,n);const o=ee(e);return he(n,o),ve(e),n};var ke=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),we=tinymce.util.Tools.resolve("tinymce.util.Tools");const Be=e=>t=>l(t)&&t.nodeName.toLowerCase()===e,Pe=e=>t=>l(t)&&e.test(t.nodeName),Me=e=>l(e)&&3===e.nodeType,Ie=e=>l(e)&&1===e.nodeType,Re=Pe(/^(OL|UL|DL)$/),Ue=Pe(/^(OL|UL)$/),$e=Be("ol"),He=Pe(/^(LI|DT|DD)$/),_e=Pe(/^(DT|DD)$/),Fe=Pe(/^(TH|TD)$/),Ve=Be("br"),je=(e,t)=>l(t)&&t.nodeName in e.schema.getTextBlockElements(),Ke=(e,t)=>l(e)&&e.nodeName in t,ze=(e,t)=>l(t)&&t.nodeName in e.schema.getVoidElements(),Qe=(e,t,n)=>{const o=e.isEmpty(t);return!(n&&e.select("span[data-mce-type=bookmark]",t).length>0)&&o},We=(e,t)=>e.isChildOf(t,e.getRoot()),qe=e=>t=>t.options.get(e),Ze=qe("lists_indent_on_tab"),Ge=qe("forced_root_block"),Je=qe("forced_root_block_attrs"),Xe=(e,t,n={})=>{const o=e.dom,r=e.schema.getBlockElements(),s=o.createFragment(),i=Ge(e),l=Je(e);let a,d,c=!1;for(d=o.create(i,{...l,...n.style?{style:n.style}:{}}),Ke(t.firstChild,r)||s.appendChild(d);a=t.firstChild;){const e=a.nodeName;c||"SPAN"===e&&"bookmark"===a.getAttribute("data-mce-type")||(c=!0),Ke(a,r)?(s.appendChild(a),d=null):(d||(d=o.create(i,l),s.appendChild(d)),d.appendChild(a))}return!c&&d&&d.appendChild(o.create("br",{"data-mce-bogus":"1"})),s},Ye=ke.DOM,et=(e,t,n)=>{const o=Ye.select('span[data-mce-type="bookmark"]',t),r=Xe(e,n),s=Ye.createRng();s.setStartAfter(n),s.setEndAfter(t);const i=s.extractContents();for(let t=i.firstChild;t;t=t.firstChild)if("LI"===t.nodeName&&e.dom.isEmpty(t)){Ye.remove(t);break}e.dom.isEmpty(i)||Ye.insertAfter(i,t),Ye.insertAfter(r,t);const l=n.parentElement;l&&Qe(e.dom,l)&&(e=>{const t=e.parentNode;t&&we.each(o,(e=>{t.insertBefore(e,n.parentNode)})),Ye.remove(e)})(l),Ye.remove(n),Qe(e.dom,t)&&Ye.remove(t)},tt=X("dd"),nt=X("dt"),ot=(e,t)=>{var n;tt(t)?Ee(t,"dt"):nt(t)&&(n=t,g.from(n.dom.parentElement).map(R.fromDom)).each((n=>et(e,n.dom,t.dom)))},rt=e=>{nt(e)&&Ee(e,"dd")},st=(e,t)=>{if(Me(e))return{container:e,offset:t};const n=Ce.getNode(e,t);return Me(n)?{container:n,offset:t>=e.childNodes.length?n.data.length:0}:n.previousSibling&&Me(n.previousSibling)?{container:n.previousSibling,offset:n.previousSibling.data.length}:n.nextSibling&&Me(n.nextSibling)?{container:n.nextSibling,offset:0}:{container:e,offset:t}},it=e=>{const t=e.cloneRange(),n=st(e.startContainer,e.startOffset);t.setStart(n.container,n.offset);const o=st(e.endContainer,e.endOffset);return t.setEnd(o.container,o.offset),t},lt=["OL","UL","DL"],at=lt.join(","),dt=(e,t)=>{const n=t||e.selection.getStart(!0);return e.dom.getParent(n,at,pt(e,n))},ct=e=>{const t=dt(e),n=e.selection.getSelectedBlocks();return((e,t)=>l(e)&&1===t.length&&t[0]===e)(t,n)?(e=>L(e.querySelectorAll(at),Re))(t):L(n,(e=>Re(e)&&t!==e))},mt=e=>{const t=e.selection.getSelectedBlocks();return L(((e,t)=>{const n=we.map(t,(t=>e.dom.getParent(t,"li,dd,dt",pt(e,t))||t));return B(n)})(e,t),He)},ut=(e,t)=>{const n=e.dom.getParents(t,"TD,TH");return n.length>0?n[0]:e.getBody()},pt=(e,t)=>{const n=e.dom.getParents(t,e.dom.isBlock),o=O(n,(t=>{return(t=>t.nodeName.toLowerCase()!==Ge(e))(t)&&(n=e.schema,!Re(o=t)&&!He(o)&&b(lt,(e=>n.isValidChild(o.nodeName,e))));var n,o}));return o.getOr(e.getBody())},ft=(e,t)=>{const n=e.dom.getParents(t,"ol,ul",pt(e,t));return w(n)},gt=e=>{const t=(e=>{const t=ft(e,e.selection.getStart()),n=L(e.selection.getSelectedBlocks(),Ue);return t.toArray().concat(n)})(e),n=(e=>{const t=e.selection.getStart();return e.dom.getParents(t,"ol,ul",pt(e,t))})(e);return O(n,(e=>{return t=R.fromDom(e),Y(t).exists((e=>He(e.dom)&&ne(e).exists((e=>!Re(e.dom)))&&oe(e).exists((e=>!Re(e.dom)))));var t})).fold((()=>ht(e,t)),(e=>[e]))},ht=(e,t)=>{const n=N(t,(t=>ft(e,t).getOr(t)));return B(n)},yt=e=>/\btox\-/.test(e.className),vt=(e,t)=>T(e,Re,Fe).exists((e=>e.nodeName===t&&!yt(e))),Ct=(e,t)=>null!==t&&!e.dom.isEditable(t),bt=(e,t)=>{const n=e.dom.getParent(t,"ol,ul,dl");return Ct(e,n)||!e.selection.isEditable()},Nt=(e,t)=>{const n=e.selection.getNode();return t({parents:e.dom.getParents(n),element:n}),e.on("NodeChange",t),()=>e.off("NodeChange",t)},St=(e,t)=>{const n=(t||document).createDocumentFragment();return S(e,(e=>{n.appendChild(e.dom)})),R.fromDom(n)},Lt=(e,t,n)=>e.dispatch("ListMutation",{action:t,element:n}),Dt=(Tt=/^\s+|\s+$/g,e=>e.replace(Tt,""));var Tt;const Ot=(e,t,n)=>{if(!o(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);(e=>void 0!==e.style&&a(e.style.getPropertyValue))(e)&&e.style.setProperty(t,n)},At=(e,t,n)=>{const o=e.dom;Ot(o,t,n)},xt=e=>H(e,"OL,UL"),Et=e=>ne(e).exists(xt),kt=e=>"listAttributes"in e,wt=e=>"isComment"in e,Bt=e=>e.depth>0,Pt=e=>e.isSelected,Mt=e=>{const t=ee(e),n=oe(e).exists(xt)?t.slice(0,-1):t;return N(n,xe)},It=(e,t)=>{ge(e.item,t.list)},Rt=(e,t)=>{const n={list:R.fromTag(t,e),item:R.fromTag("li",e)};return ge(n.list,n.item),n},Ut=(e,t,n)=>{const o=t.slice(0,n.depth);return w(o).each((t=>{if(kt(n)){const o=((e,t,n)=>{const o=R.fromTag("li",e);return Oe(o,t),he(o,n),o})(e,n.itemAttributes,n.content);((e,t)=>{ge(e.list,t),e.item=t})(t,o),((e,t)=>{z(e.list)!==t.listType&&(e.list=Ee(e.list,t.listType)),Oe(e.list,t.listAttributes)})(t,n)}else if((e=>"isFragment"in e)(n))he(t.item,n.content);else{const e=R.fromHtml(`\x3c!--${n.content}--\x3e`);ge(t.list,e)}})),o},$t=(e,t,n)=>{const o=((e,t,n)=>{const o=[];for(let r=0;r<n;r++)o.push(Rt(e,kt(t)?t.listType:t.parentListType));return o})(e,n,n.depth-t.length);var r;return(e=>{for(let t=1;t<e.length;t++)It(e[t-1],e[t])})(o),((e,t)=>{for(let t=0;t<e.length-1;t++)At(e[t].item,"list-style-type","none");w(e).each((e=>{kt(t)&&(Oe(e.list,t.listAttributes),Oe(e.item,t.itemAttributes)),he(e.item,t.content)}))})(o,n),r=o,M(w(t),k(r),It),t.concat(o)},Ht=(e,t)=>{let n=g.none();const o=D(t,((t,o,r)=>wt(o)?0===r?(n=g.some(o),t):Ut(e,t,o):o.depth>t.length?$t(e,t,o):Ut(e,t,o)),[]);return n.each((e=>{const t=R.fromHtml(`\x3c!--${e.content}--\x3e`);k(o).each((e=>{((e,t)=>{ne(e).fold((()=>{ge(e,t)}),(n=>{e.dom.insertBefore(t.dom,n.dom)}))})(e.list,t)}))})),k(o).map((e=>e.list))},_t=e=>(S(e,((t,n)=>{((e,t)=>{const n=e[t].depth,o=e=>e.depth===n&&!e.dirty,r=e=>e.depth<n;return T(x(e.slice(0,t)),o,r).orThunk((()=>T(e.slice(t+1),o,r)))})(e,n).fold((()=>{t.dirty&&kt(t)&&(e=>{e.listAttributes=Te(e.listAttributes,((e,t)=>"start"!==t))})(t)}),(e=>{return o=e,void(kt(n=t)&&kt(o)&&(n.listType=o.listType,n.listAttributes={...o.listAttributes}));var n,o}))})),e),Ft=(e,t,n,o)=>{var r,s;if(8===Q(s=o)||"#comment"===z(s))return[{depth:e+1,content:null!==(r=o.dom.nodeValue)&&void 0!==r?r:"",dirty:!1,isSelected:!1,isComment:!0}];t.each((e=>{$(e.start,o)&&n.set(!0)}));const i=((e,t,n)=>Y(e).filter(Z).map((o=>({depth:t,dirty:!1,isSelected:n,content:Mt(e),itemAttributes:Ae(e),listAttributes:Ae(o),listType:z(o),isInPreviousLi:!1}))))(o,e,n.get());t.each((e=>{$(e.end,o)&&n.set(!1)}));const l=oe(o).filter(xt).map((o=>jt(e,t,n,o))).getOr([]);return i.toArray().concat(l)},Vt=(e,t,n,o)=>ne(o).filter(xt).fold((()=>Ft(e,t,n,o)),(r=>{const s=D(ee(o),((o,s,i)=>{if(0===i)return o;if(H(s,"LI"))return o.concat(Ft(e,t,n,s));{const t={isFragment:!0,depth:e,content:[s],isSelected:!1,dirty:!1,parentListType:z(r)};return o.concat(t)}}),[]);return jt(e,t,n,r).concat(s)})),jt=(e,t,n,o)=>A(ee(o),(o=>(xt(o)?jt:Vt)(e+1,t,n,o))),Kt=(e,t)=>A(((e,t)=>{if(0===e.length)return[];{let n=t(e[0]);const o=[];let r=[];for(let s=0,i=e.length;s<i;s++){const i=e[s],l=t(i);l!==n&&(o.push(r),r=[]),n=l,r.push(i)}return 0!==r.length&&o.push(r),o}})(t,Bt),(t=>k(t).exists(Bt)?((e,t)=>{const n=_t(t);return Ht(e.contentDocument,n).toArray()})(e,t):((e,t)=>{const n=_t(t);return N(n,(t=>{const n=wt(t)?St([R.fromHtml(`\x3c!--${t.content}--\x3e`)]):St(t.content),o=kt(t)?t.itemAttributes:{};return R.fromDom(Xe(e,n.dom,o))}))})(e,t))),zt=(e,t,n)=>{const o=((e,t)=>{const n=(()=>{let e=!1;return{get:()=>e,set:t=>{e=t}}})();return N(e,(e=>({sourceList:e,entries:jt(0,t,n,e)})))})(t,(e=>{const t=N(mt(e),R.fromDom);return M(O(t,p(Et)),O(x(t),p(Et)),((e,t)=>({start:e,end:t})))})(e));S(o,(t=>{((e,t)=>{S(L(e,Pt),(e=>((e,t)=>{switch(e){case"Indent":t.depth++;break;case"Outdent":t.depth--;break;case"Flatten":t.depth=0}t.dirty=!0})(t,e)))})(t.entries,n);const o=Kt(e,t.entries);var r;S(o,(t=>{Lt(e,"Indent"===n?"IndentList":"OutdentList",t.dom)})),r=t.sourceList,S(o,(e=>{pe(r,e)})),ve(t.sourceList)}))},Qt=(e,t)=>{const n=Se(gt(e)),o=Se((e=>L(mt(e),_e))(e));let r=!1;if(n.length||o.length){const s=e.selection.getBookmark();zt(e,n,t),((e,t,n)=>{S(n,"Indent"===t?rt:t=>ot(e,t))})(e,t,o),e.selection.moveToBookmark(s),e.selection.setRng(it(e.selection.getRng())),e.nodeChanged(),r=!0}return r},Wt=(e,t)=>!(e=>{const t=dt(e);return Ct(e,t)||!e.selection.isEditable()})(e)&&Qt(e,t),qt=e=>Wt(e,"Indent"),Zt=e=>Wt(e,"Outdent"),Gt=e=>Wt(e,"Flatten"),Jt=e=>"\ufeff"===e,Xt=(e,t)=>{return n=e,o=function(e,...t){return(...n)=>{const o=t.concat(n);return e.apply(null,o)}}($,t),ae(n,o,r).isSome();var n,o,r};var Yt=tinymce.util.Tools.resolve("tinymce.dom.BookmarkManager");const en=ke.DOM,tn=e=>{const t={},n=n=>{let o=e[n?"startContainer":"endContainer"],r=e[n?"startOffset":"endOffset"];if(Ie(o)){const e=en.create("span",{"data-mce-type":"bookmark"});o.hasChildNodes()?(r=Math.min(r,o.childNodes.length-1),n?o.insertBefore(e,o.childNodes[r]):en.insertAfter(e,o.childNodes[r])):o.appendChild(e),o=e,r=0}t[n?"startContainer":"endContainer"]=o,t[n?"startOffset":"endOffset"]=r};return n(!0),e.collapsed||n(),t},nn=e=>{const t=t=>{let n=e[t?"startContainer":"endContainer"],o=e[t?"startOffset":"endOffset"];if(n){if(Ie(n)&&n.parentNode){const e=n;o=(e=>{var t;let n=null===(t=e.parentNode)||void 0===t?void 0:t.firstChild,o=0;for(;n;){if(n===e)return o;Ie(n)&&"bookmark"===n.getAttribute("data-mce-type")||o++,n=n.nextSibling}return-1})(n),n=n.parentNode,en.remove(e),!n.hasChildNodes()&&en.isBlock(n)&&n.appendChild(en.create("br"))}e[t?"startContainer":"endContainer"]=n,e[t?"startOffset":"endOffset"]=o}};t(!0),t();const n=en.createRng();return n.setStart(e.startContainer,e.startOffset),e.endContainer&&n.setEnd(e.endContainer,e.endOffset),it(n)},on=e=>{switch(e){case"UL":return"ToggleUlList";case"OL":return"ToggleOlList";case"DL":return"ToggleDLList"}},rn=(e,t)=>{we.each(t,((t,n)=>{e.setAttribute(n,t)}))},sn=(e,t,n)=>{((e,t,n)=>{const o=n["list-style-type"]?n["list-style-type"]:null;e.setStyle(t,"list-style-type",o)})(e,t,n),((e,t,n)=>{rn(t,n["list-attributes"]),we.each(e.select("li",t),(e=>{rn(e,n["list-item-attributes"])}))})(e,t,n)},ln=(e,t)=>l(t)&&!Ke(t,e.schema.getBlockElements()),an=(e,t,n,o)=>{let r=t[n?"startContainer":"endContainer"];const s=t[n?"startOffset":"endOffset"];Ie(r)&&(r=r.childNodes[Math.min(s,r.childNodes.length-1)]||r),!n&&Ve(r.nextSibling)&&(r=r.nextSibling);const i=(t,n)=>{var r;const s=new be(t,(t=>{for(;!e.dom.isBlock(t)&&t.parentNode&&o!==t;)t=t.parentNode;return t})(t)),i=n?"next":"prev";let l;for(;l=s[i]();)if(!ze(e,l)&&!Jt(l.textContent)&&0!==(null===(r=l.textContent)||void 0===r?void 0:r.length))return g.some(l);return g.none()};if(n&&Me(r))if(Jt(r.textContent))r=i(r,!1).getOr(r);else for(null!==r.parentNode&&ln(e,r.parentNode)&&(r=r.parentNode);null!==r.previousSibling&&(ln(e,r.previousSibling)||Me(r.previousSibling));)r=r.previousSibling;if(!n&&Me(r))if(Jt(r.textContent))r=i(r,!0).getOr(r);else for(null!==r.parentNode&&ln(e,r.parentNode)&&(r=r.parentNode);null!==r.nextSibling&&(ln(e,r.nextSibling)||Me(r.nextSibling));)r=r.nextSibling;for(;r.parentNode!==o;){const t=r.parentNode;if(je(e,r))return r;if(/^(TD|TH)$/.test(t.nodeName))return r;r=t}return r},dn=(e,t,n)=>{const o=e.selection.getRng();let r="LI";const s=pt(e,((e,t)=>{const n=e.selection.getStart(!0),o=an(e,t,!0,e.getBody());return Xt(R.fromDom(o),R.fromDom(t.commonAncestorContainer))?t.commonAncestorContainer:n})(e,o)),i=e.dom;if("false"===i.getContentEditable(e.selection.getNode()))return;"DL"===(t=t.toUpperCase())&&(r="DT");const l=tn(o),a=L(((e,t,n)=>{const o=[],r=e.dom,s=an(e,t,!0,n),i=an(e,t,!1,n);let l;const a=[];for(let e=s;e&&(a.push(e),e!==i);e=e.nextSibling);return we.each(a,(t=>{var s;if(je(e,t))return o.push(t),void(l=null);if(r.isBlock(t)||Ve(t))return Ve(t)&&r.remove(t),void(l=null);const i=t.nextSibling;Yt.isBookmarkNode(t)&&(Re(i)||je(e,i)||!i&&t.parentNode===n)?l=null:(l||(l=r.create("p"),null===(s=t.parentNode)||void 0===s||s.insertBefore(l,t),o.push(l)),l.appendChild(t))})),o})(e,o,s),e.dom.isEditable);we.each(a,(o=>{let s;const l=o.previousSibling,a=o.parentNode;He(a)||(l&&Re(l)&&l.nodeName===t&&((e,t,n)=>{const o=e.getStyle(t,"list-style-type");let r=n?n["list-style-type"]:"";return r=null===r?"":r,o===r})(i,l,n)?(s=l,o=i.rename(o,r),l.appendChild(o)):(s=i.create(t),a.insertBefore(s,o),s.appendChild(o),o=i.rename(o,r)),((e,t,n)=>{we.each(n,(n=>e.setStyle(t,n,"")))})(i,o,["margin","margin-right","margin-bottom","margin-left","margin-top","padding","padding-right","padding-bottom","padding-left","padding-top"]),sn(i,s,n),mn(e.dom,s))})),e.selection.setRng(nn(l))},cn=(e,t,n)=>{return((e,t)=>Re(e)&&e.nodeName===(null==t?void 0:t.nodeName))(t,n)&&((e,t,n)=>e.getStyle(t,"list-style-type",!0)===e.getStyle(n,"list-style-type",!0))(e,t,n)&&(o=n,t.className===o.className);var o},mn=(e,t)=>{let n,o=t.nextSibling;if(cn(e,t,o)){const r=o;for(;n=r.firstChild;)t.appendChild(n);e.remove(r)}if(o=t.previousSibling,cn(e,t,o)){const r=o;for(;n=r.lastChild;)t.insertBefore(n,t.firstChild);e.remove(r)}},un=(e,t,n,o)=>{if(t.nodeName!==n){const r=e.dom.rename(t,n);sn(e.dom,r,o),Lt(e,on(n),r)}else sn(e.dom,t,o),Lt(e,on(n),t)},pn=(e,t,n,o)=>{if(t.classList.forEach(((e,n,o)=>{e.startsWith("tox-")&&(o.remove(e),0===o.length&&t.removeAttribute("class"))})),t.nodeName!==n){const r=e.dom.rename(t,n);sn(e.dom,r,o),Lt(e,on(n),r)}else sn(e.dom,t,o),Lt(e,on(n),t)},fn=e=>"list-style-type"in e,gn=(e,t,n)=>{const o=dt(e);if(bt(e,o))return;const s=ct(e),i=r(n)?n:{};s.length>0?((e,t,n,o,r)=>{const s=Re(t);if(!s||t.nodeName!==o||fn(r)||yt(t)){dn(e,o,r);const i=tn(e.selection.getRng()),l=s?[t,...n]:n,a=s&&yt(t)?pn:un;we.each(l,(t=>{a(e,t,o,r)})),e.selection.setRng(nn(i))}else Gt(e)})(e,o,s,t,i):((e,t,n,o)=>{if(t!==e.getBody())if(t)if(t.nodeName!==n||fn(o)||yt(t)){const r=tn(e.selection.getRng());yt(t)&&t.classList.forEach(((e,n,o)=>{e.startsWith("tox-")&&(o.remove(e),0===o.length&&t.removeAttribute("class"))})),sn(e.dom,t,o);const s=e.dom.rename(t,n);mn(e.dom,s),e.selection.setRng(nn(r)),dn(e,n,o),Lt(e,on(n),s)}else Gt(e);else dn(e,n,o),Lt(e,on(n),t)})(e,o,t,i)},hn=ke.DOM,yn=(e,t)=>{const n=we.grep(e.select("ol,ul",t));we.each(n,(t=>{((e,t)=>{const n=t.parentElement;if(n&&"LI"===n.nodeName&&n.firstChild===t){const o=n.previousSibling;o&&"LI"===o.nodeName?(o.appendChild(t),Qe(e,n)&&hn.remove(n)):hn.setStyle(n,"listStyleType","none")}if(Re(n)){const e=n.previousSibling;e&&"LI"===e.nodeName&&e.appendChild(t)}})(e,t)}))},vn=(e,t,n,o)=>{let r=t.startContainer;const s=t.startOffset;if(Me(r)&&(n?s<r.data.length:s>0))return r;const i=e.schema.getNonEmptyElements();Ie(r)&&(r=Ce.getNode(r,s));const l=new be(r,o);n&&((e,t)=>!!Ve(t)&&e.isBlock(t.nextSibling)&&!Ve(t.previousSibling))(e.dom,r)&&l.next();const a=n?l.next.bind(l):l.prev2.bind(l);for(;r=a();){if("LI"===r.nodeName&&!r.hasChildNodes())return r;if(i[r.nodeName])return r;if(Me(r)&&r.data.length>0)return r}return null},Cn=(e,t)=>{const n=t.childNodes;return 1===n.length&&!Re(n[0])&&e.isBlock(n[0])},bn=e=>g.from(e).map(R.fromDom).filter(q).exists((e=>((e,t=!1)=>ie(e)?e.dom.isContentEditable:me(e).fold(m(t),(e=>"true"===ue(e))))(e)&&!C(["details"],z(e)))),Nn=(e,t,n)=>{let o;const r=Cn(e,n)?n.firstChild:n;if(((e,t)=>{Cn(e,t)&&bn(t.firstChild)&&e.remove(t.firstChild,!0)})(e,t),!Qe(e,t,!0))for(;o=t.firstChild;)r.appendChild(o)},Sn=(e,t,n)=>{let o;const r=t.parentNode;if(!We(e,t)||!We(e,n))return;Re(n.lastChild)&&(o=n.lastChild),r===n.lastChild&&Ve(r.previousSibling)&&e.remove(r.previousSibling);const s=n.lastChild;s&&Ve(s)&&t.hasChildNodes()&&e.remove(s),Qe(e,n,!0)&&ye(R.fromDom(n)),Nn(e,t,n),o&&n.appendChild(o);const i=((e,t)=>{const n=e.dom,o=t.dom;return n!==o&&n.contains(o)})(R.fromDom(n),R.fromDom(t))?e.getParents(t,Re,n):[];e.remove(t),S(i,(t=>{Qe(e,t)&&t!==e.getRoot()&&e.remove(t)}))},Ln=(e,t,n,o)=>{const r=e.dom;if(r.isEmpty(o))((e,t,n)=>{ye(R.fromDom(n)),Sn(e.dom,t,n),e.selection.setCursorLocation(n,0)})(e,n,o);else{const s=tn(t);Sn(r,n,o),e.selection.setRng(nn(s))}},Dn=(e,t)=>{const n=e.dom,o=e.selection,r=o.getStart(),s=ut(e,r),i=n.getParent(o.getStart(),"LI",s);if(i){const r=i.parentElement;if(r===e.getBody()&&Qe(n,r))return!0;const l=it(o.getRng()),a=n.getParent(vn(e,l,t,s),"LI",s),d=a&&(t?n.isChildOf(i,a):n.isChildOf(a,i));if(a&&a!==i&&!d)return e.undoManager.transact((()=>{var n,o;t?Ln(e,l,a,i):(null===(o=(n=i).parentNode)||void 0===o?void 0:o.firstChild)===n?Zt(e):((e,t,n,o)=>{const r=tn(t);Sn(e.dom,n,o);const s=nn(r);e.selection.setRng(s)})(e,l,i,a)})),!0;if(d&&!t&&a!==i)return e.undoManager.transact((()=>{if(l.commonAncestorContainer.parentElement){const t=tn(l),o=l.commonAncestorContainer.parentElement;Nn(n,l.commonAncestorContainer.parentElement,a),o.remove();const r=nn(t);e.selection.setRng(r)}})),!0;if(!a&&!t&&0===l.startOffset&&0===l.endOffset)return e.undoManager.transact((()=>{Gt(e)})),!0}return!1},Tn=(e,t)=>{const n=e.dom,o=e.selection.getStart(),r=ut(e,o),s=n.getParent(o,n.isBlock,r);if(s&&n.isEmpty(s,void 0,{checkRootAsContent:!0})){const o=it(e.selection.getRng()),i=n.getParent(vn(e,o,t,r),"LI",r);if(i){const l=e=>C(["td","th","caption"],z(e)),a=e=>e.dom===r;return!!((e,t,n=u)=>M(e,t,n).getOr(e.isNone()&&t.isNone()))(de(R.fromDom(i),l,a),de(R.fromDom(o.startContainer),l,a),$)&&(e.undoManager.transact((()=>{const o=i.parentNode;((e,t,n)=>{const o=e.getParent(t.parentNode,e.isBlock,n);e.remove(t),o&&e.isEmpty(o)&&e.remove(o)})(n,s,r),mn(n,o),e.selection.select(i,!0),e.selection.collapse(t)})),!0)}}return!1},On=e=>{const t=e.selection.getStart(),n=ut(e,t);return e.dom.getParent(t,"LI,DT,DD",n)||mt(e).length>0},An=(e,t)=>{const n=e.selection;return!bt(e,n.getNode())&&(n.isCollapsed()?((e,t)=>Dn(e,t)||Tn(e,t))(e,t):(e=>!!On(e)&&(e.undoManager.transact((()=>{let t=!0;const n=()=>t=!1;e.on("input",n),e.execCommand("Delete"),e.off("input",n),t&&e.dispatch("input"),yn(e.dom,e.getBody())})),!0))(e))},xn=e=>{const t=x(Dt(e).split("")),n=N(t,((e,t)=>{const n=e.toUpperCase().charCodeAt(0)-"A".charCodeAt(0)+1;return Math.pow(26,t)*n}));return D(n,((e,t)=>e+t),0)},En=e=>{if(--e<0)return"";{const t=e%26,n=Math.floor(e/26);return En(n)+String.fromCharCode("A".charCodeAt(0)+t)}},kn=e=>{const t=parseInt(e.start,10);return P(e.listStyleType,"upper-alpha")?En(t):P(e.listStyleType,"lower-alpha")?En(t).toLowerCase():e.start},wn=e=>{const t=dt(e);$e(t)&&!bt(e,t)&&e.windowManager.open({title:"List Properties",body:{type:"panel",items:[{type:"input",name:"start",label:"Start list at number",inputMode:"numeric"}]},initialData:{start:kn({start:e.dom.getAttrib(t,"start","1"),listStyleType:g.from(e.dom.getStyle(t,"list-style-type"))})},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],onSubmit:t=>{(e=>{switch((e=>/^[0-9]+$/.test(e)?2:/^[A-Z]+$/.test(e)?0:(e=>/^[a-z]+$/.test(e))(e)?1:e.length>0?4:3)(e)){case 2:return g.some({listStyleType:g.none(),start:e});case 0:return g.some({listStyleType:g.some("upper-alpha"),start:xn(e).toString()});case 1:return g.some({listStyleType:g.some("lower-alpha"),start:xn(e).toString()});case 3:return g.some({listStyleType:g.none(),start:""});case 4:return g.none()}})(t.getData().start).each((t=>{e.execCommand("mceListUpdate",!1,{attrs:{start:"1"===t.start?"":t.start},styles:{"list-style-type":t.listStyleType.getOr("")}})})),t.close()}})},Bn=(e,t)=>()=>{const n=dt(e);return l(n)&&n.nodeName===t},Pn=e=>{e.addCommand("mceListProps",(()=>{wn(e)}))},Mn=e=>{e.on("BeforeExecCommand",(t=>{const n=t.command.toLowerCase();"indent"===n?qt(e):"outdent"===n&&Zt(e)})),e.addCommand("InsertUnorderedList",((t,n)=>{gn(e,"UL",n)})),e.addCommand("InsertOrderedList",((t,n)=>{gn(e,"OL",n)})),e.addCommand("InsertDefinitionList",((t,n)=>{gn(e,"DL",n)})),e.addCommand("RemoveList",(()=>{Gt(e)})),Pn(e),e.addCommand("mceListUpdate",((t,n)=>{r(n)&&((e,t)=>{const n=dt(e);null===n||bt(e,n)||e.undoManager.transact((()=>{r(t.styles)&&e.dom.setStyles(n,t.styles),r(t.attrs)&&De(t.attrs,((t,o)=>e.dom.setAttrib(n,o,t)))}))})(e,n)})),e.addQueryStateHandler("InsertUnorderedList",Bn(e,"UL")),e.addQueryStateHandler("InsertOrderedList",Bn(e,"OL")),e.addQueryStateHandler("InsertDefinitionList",Bn(e,"DL"))};var In=tinymce.util.Tools.resolve("tinymce.html.Node");const Rn=e=>3===e.type,Un=e=>0===e.length,$n=e=>{const t=(t,n)=>{const o=In.create("li");S(t,(e=>o.append(e))),n?e.insert(o,n,!0):e.append(o)},n=D(e.children(),((e,n)=>Rn(n)?[...e,n]:Un(e)||Rn(n)?e:(t(e,n),[])),[]);Un(n)||t(n)},Hn=e=>{Ze(e)&&(e=>{e.on("keydown",(t=>{t.keyCode!==Ne.TAB||Ne.metaKeyPressed(t)||e.undoManager.transact((()=>{(t.shiftKey?Zt(e):qt(e))&&t.preventDefault()}))}))})(e),(e=>{e.on("ExecCommand",(t=>{const n=t.command.toLowerCase();"delete"!==n&&"forwarddelete"!==n||!On(e)||yn(e.dom,e.getBody())})),e.on("keydown",(t=>{t.keyCode===Ne.BACKSPACE?An(e,!1)&&t.preventDefault():t.keyCode===Ne.DELETE&&An(e,!0)&&t.preventDefault()}))})(e)},_n=(e,t)=>n=>(n.setEnabled(e.selection.isEditable()),Nt(e,(o=>{n.setActive(vt(o.parents,t)),n.setEnabled(!bt(e,o.element)&&e.selection.isEditable())}))),Fn=(e,t)=>n=>Nt(e,(o=>n.setEnabled(vt(o.parents,t)&&!bt(e,o.element))));e.add("lists",(e=>((e=>{(0,e.options.register)("lists_indent_on_tab",{processor:"boolean",default:!0})})(e),(e=>{e.on("PreInit",(()=>{const{parser:t}=e;t.addNodeFilter("ul,ol",(e=>S(e,$n)))}))})(e),e.hasPlugin("rtc",!0)?Pn(e):(Hn(e),Mn(e)),(e=>{const t=t=>()=>e.execCommand(t);e.hasPlugin("advlist")||(e.ui.registry.addToggleButton("numlist",{icon:"ordered-list",active:!1,tooltip:"Numbered list",onAction:t("InsertOrderedList"),onSetup:_n(e,"OL")}),e.ui.registry.addToggleButton("bullist",{icon:"unordered-list",active:!1,tooltip:"Bullet list",onAction:t("InsertUnorderedList"),onSetup:_n(e,"UL")}))})(e),(e=>{const t={text:"List properties...",icon:"ordered-list",onAction:()=>e.execCommand("mceListProps"),onSetup:Fn(e,"OL")};e.ui.registry.addMenuItem("listprops",t),e.ui.registry.addContextMenu("lists",{update:t=>{const n=dt(e,t);return $e(n)?["listprops"]:[]}})})(e),(e=>({backspaceDelete:t=>{An(e,t)}}))(e))))}();